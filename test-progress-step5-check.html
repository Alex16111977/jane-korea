<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>TEST: Progress Step 5 - lessons.html Integration</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            font-weight: 600;
        }
        .pass {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        .fail {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }
        h1 {
            color: #333;
        }
        h2 {
            color: #667eea;
        }
        .summary {
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        .summary.success {
            background: #d4edda;
            color: #155724;
        }
        .summary.warning {
            background: #fff3cd;
            color: #856404;
        }
    </style>
</head>
<body>
    <h1>üß™ TEST: –ö—Ä–æ–∫ 5 - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ lessons.html</h1>
    
    <div class="test-section">
        <h2>üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–∞–π–ª—ñ–≤</h2>
        <div id="fileTests"></div>
    </div>
    
    <div class="test-section">
        <h2>üîå –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤</h2>
        <div id="moduleTests"></div>
    </div>
    
    <div class="test-section">
        <h2>üíæ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ localStorage</h2>
        <div id="storageTests"></div>
    </div>
    
    <div class="test-section">
        <h2>üé® –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–∑—É–∞–ª—å–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤</h2>
        <div id="visualTests"></div>
    </div>
    
    <div class="test-section">
        <h2>‚öôÔ∏è –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ</h2>
        <div id="functionalTests"></div>
    </div>
    
    <div id="summary" class="summary"></div>
    
    <script>
        let passCount = 0;
        let failCount = 0;
        
        function test(containerId, name, condition, details = '') {
            const container = document.getElementById(containerId);
            const result = document.createElement('div');
            result.className = 'test-result ' + (condition ? 'pass' : 'fail');
            
            const status = condition ? '[PASS]' : '[FAIL]';
            result.innerHTML = `${status} ${name}${details ? '<br><small>' + details + '</small>' : ''}`;
            
            container.appendChild(result);
            
            if (condition) {
                passCount++;
            } else {
                failCount++;
            }
            
            console.log(`${status} ${name}`);
        }
        
        function info(containerId, message) {
            const container = document.getElementById(containerId);
            const result = document.createElement('div');
            result.className = 'test-result info';
            result.innerHTML = `[INFO] ${message}`;
            container.appendChild(result);
            console.log(`[INFO] ${message}`);
        }
        
        // === –¢–ï–°–¢ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–∞–π–ª—ñ–≤ ===
        async function testFiles() {
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è progress-tracker.js
            try {
                const response1 = await fetch('js/progress-tracker.js');
                test('fileTests', '–§–∞–π–ª js/progress-tracker.js —ñ—Å–Ω—É—î', response1.ok);
            } catch (e) {
                test('fileTests', '–§–∞–π–ª js/progress-tracker.js —ñ—Å–Ω—É—î', false, e.message);
            }
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è progress-dashboard.js
            try {
                const response2 = await fetch('js/progress-dashboard.js');
                test('fileTests', '–§–∞–π–ª js/progress-dashboard.js —ñ—Å–Ω—É—î', response2.ok);
            } catch (e) {
                test('fileTests', '–§–∞–π–ª js/progress-dashboard.js —ñ—Å–Ω—É—î', false, e.message);
            }
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è progress.css
            try {
                const response3 = await fetch('css/progress.css');
                test('fileTests', '–§–∞–π–ª css/progress.css —ñ—Å–Ω—É—î', response3.ok);
            } catch (e) {
                test('fileTests', '–§–∞–π–ª css/progress.css —ñ—Å–Ω—É—î', false, e.message);
            }
        }
        
        // === –¢–ï–°–¢ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–æ–¥—É–ª—ñ–≤ ===
        function testModules() {
            test('moduleTests', 'ProgressTracker –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', typeof ProgressTracker !== 'undefined');
            
            if (typeof ProgressTracker !== 'undefined') {
                test('moduleTests', 'ProgressTracker.init —ñ—Å–Ω—É—î', typeof ProgressTracker.init === 'function');
                test('moduleTests', 'ProgressTracker.get —ñ—Å–Ω—É—î', typeof ProgressTracker.get === 'function');
                test('moduleTests', 'ProgressTracker.markLessonCompleted —ñ—Å–Ω—É—î', typeof ProgressTracker.markLessonCompleted === 'function');
            }
            
            test('moduleTests', 'ProgressDashboard –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', typeof ProgressDashboard !== 'undefined');
            
            if (typeof ProgressDashboard !== 'undefined') {
                test('moduleTests', 'ProgressDashboard.render —ñ—Å–Ω—É—î', typeof ProgressDashboard.render === 'function');
            }
        }
        
        // === –¢–ï–°–¢ 3: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ localStorage ===
        function testStorage() {
            // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–≥—Ä–µ—Å—É
            if (typeof ProgressTracker !== 'undefined') {
                ProgressTracker.init();
                
                const progress = ProgressTracker.get();
                test('storageTests', 'localStorage –º–∞—î –∫–ª—é—á janeKoreaProgress', progress !== null);
                test('storageTests', '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ completedLessons —ñ—Å–Ω—É—î', progress.completedLessons !== undefined);
                test('storageTests', '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ stats —ñ—Å–Ω—É—î', progress.stats !== undefined);
                
                // –¢–µ—Å—Ç–æ–≤–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
                ProgressTracker.markLessonCompleted('level_1');
                const updatedProgress = ProgressTracker.get();
                test('storageTests', '–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è –ø—Ä–∞—Ü—é—î', updatedProgress.completedLessons['level_1'] !== undefined);
                
                info('storageTests', `–í—Å—å–æ–≥–æ –ø—Ä–æ–π–¥–µ–Ω–æ —Ä—ñ–≤–Ω—ñ–≤: ${Object.keys(updatedProgress.completedLessons).length}`);
            } else {
                test('storageTests', 'ProgressTracker –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ', false);
            }
        }
        
        // === –¢–ï–°–¢ 4: –í—ñ–∑—É–∞–ª—å–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ ===
        function testVisual() {
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞–Ω–µ–ª—ñ –ø—Ä–æ–≥—Ä–µ—Å—É
            const dashboard = document.getElementById('progressDashboard');
            test('visualTests', '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä #progressDashboard —ñ—Å–Ω—É—î –Ω–∞ lessons.html', dashboard !== null);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ CSS –∫–ª–∞—Å—ñ–≤
            const styles = document.styleSheets;
            let hasProgressStyles = false;
            for (let i = 0; i < styles.length; i++) {
                try {
                    const cssText = [...styles[i].cssRules].map(r => r.cssText).join('');
                    if (cssText.includes('progress-dashboard') || cssText.includes('completion-badge')) {
                        hasProgressStyles = true;
                        break;
                    }
                } catch (e) {
                    // –Ü–≥–Ω–æ—Ä—É—î–º–æ CORS –ø–æ–º–∏–ª–∫–∏
                }
            }
            test('visualTests', 'CSS —Å—Ç–∏–ª—ñ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ', hasProgressStyles);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–Ω–æ–ø–∫–∏ —Å–∫–∏–¥–∞–Ω–Ω—è
            setTimeout(() => {
                const resetButton = document.querySelector('.reset-progress');
                test('visualTests', '–ö–Ω–æ–ø–∫–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É —ñ—Å–Ω—É—î', resetButton !== null);
            }, 1000);
        }
        
        // === –¢–ï–°–¢ 5: –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å ===
        function testFunctional() {
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü—ñ—ó markCompletedLessons
            test('functionalTests', '–§—É–Ω–∫—Ü—ñ—è markCompletedLessons –≤–∏–∑–Ω–∞—á–µ–Ω–∞', typeof markCompletedLessons === 'function');
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∫–ª—ñ–∫—ñ–≤
            const hasClickListener = window.addEventListener !== undefined;
            test('functionalTests', 'Event listeners –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è', hasClickListener);
            
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü—ñ—ó navigateToLevel
            test('functionalTests', '–§—É–Ω–∫—Ü—ñ—è navigateToLevel –≤–∏–∑–Ω–∞—á–µ–Ω–∞', typeof navigateToLevel === 'function');
            
            info('functionalTests', '–î–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É –≤—ñ–¥–∫—Ä–∏–π—Ç–µ lessons.html —ñ –∫–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ —Ä—ñ–≤–µ–Ω—å');
        }
        
        // === –ó–ê–ü–£–°–ö –¢–ï–°–¢–Ü–í ===
        async function runAllTests() {
            console.log('=== –ü–û–ß–ê–¢–û–ö –¢–ï–°–¢–£–í–ê–ù–ù–Ø ===');
            
            await testFiles();
            testModules();
            testStorage();
            testVisual();
            testFunctional();
            
            // –ü—ñ–¥—Å—É–º–æ–∫
            const total = passCount + failCount;
            const percent = Math.round((passCount / total) * 100);
            
            const summary = document.getElementById('summary');
            summary.className = 'summary ' + (failCount === 0 ? 'success' : 'warning');
            summary.innerHTML = `
                <div>üìä –†–ï–ó–£–õ–¨–¢–ê–¢ –¢–ï–°–¢–£–í–ê–ù–ù–Ø</div>
                <div style="font-size: 2em; margin: 10px 0;">${passCount}/${total} —Ç–µ—Å—Ç—ñ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ (${percent}%)</div>
                ${failCount === 0 ? 
                    '‚úÖ –í—Å—ñ —Ç–µ—Å—Ç–∏ —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ñ!' : 
                    `‚ö†Ô∏è –Ñ ${failCount} –Ω–µ–ø—Ä–æ–π–¥–µ–Ω–∏—Ö —Ç–µ—Å—Ç—ñ–≤`
                }
            `;
            
            console.log('=== –ö–Ü–ù–ï–¶–¨ –¢–ï–°–¢–£–í–ê–ù–ù–Ø ===');
            console.log(`[SUMMARY] ${passCount}/${total} passed (${percent}%)`);
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        window.addEventListener('load', runAllTests);
    </script>
</body>
</html>
